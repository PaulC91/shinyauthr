<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shiny Authentication Modules • shinyauthr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Shiny Authentication Modules">
<meta property="og:description" content="Add in-app user authentication to shiny, 
    allowing you to secure publicly hosted apps and 
    build dynamic user interfaces from user information.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">shinyauthr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/paulc91/shinyauthr" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="shinyauthr">shinyauthr<a class="anchor" aria-label="anchor" href="#shinyauthr"></a>
</h1></div>
<!-- badges: start -->

<!-- badges: end -->
<p><code>shinyauthr</code> is an R package providing module functions that can be used to add an authentication layer to your shiny apps.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the package from <a href="https://cran.r-project.org/package=shinyauthr" class="external-link">CRAN</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"shinyauthr"</span><span class="op">)</span></span></code></pre></div>
<p>Or the development version from github with the <a href="https://github.com/r-lib/remotes" class="external-link">remotes package</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"paulc91/shinyauthr"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="run-example-apps">Run example apps<a class="anchor" aria-label="anchor" href="#run-example-apps"></a>
</h2>
<p>Code for example apps using various UI frameworks can be found in <a href="inst/shiny-examples">inst/shiny-examples</a>. You can launch 3 example apps with the <code>runExample</code> function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># login with user1 pass1 or user2 pass2</span></span>
<span><span class="fu">shinyauthr</span><span class="fu">::</span><span class="fu"><a href="reference/runExample.html">runExample</a></span><span class="op">(</span><span class="st">"basic"</span><span class="op">)</span></span>
<span><span class="fu">shinyauthr</span><span class="fu">::</span><span class="fu"><a href="reference/runExample.html">runExample</a></span><span class="op">(</span><span class="st">"shinydashboard"</span><span class="op">)</span></span>
<span><span class="fu">shinyauthr</span><span class="fu">::</span><span class="fu"><a href="reference/runExample.html">runExample</a></span><span class="op">(</span><span class="st">"navbarPage"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>The package provides 2 module functions each with a UI and server element:</p>
<ul>
<li><code><a href="reference/loginUI.html">loginUI()</a></code></li>
<li><code><a href="reference/loginServer.html">loginServer()</a></code></li>
<li><code><a href="reference/logoutUI.html">logoutUI()</a></code></li>
<li><code><a href="reference/logoutServer.html">logoutServer()</a></code></li>
</ul>
<p><strong>Note</strong>: the server modules use shiny’s new (version &gt;= 1.5.0) <code><a href="https://rdrr.io/pkg/shiny/man/moduleServer.html" class="external-link">shiny::moduleServer</a></code> method as opposed to the <code><a href="https://rdrr.io/pkg/shiny/man/callModule.html" class="external-link">shiny::callModule</a></code> method used by the now deprecated <code><a href="reference/login.html">shinyauthr::login</a></code> and <code><a href="reference/logout.html">shinyauthr::logout</a></code> functions. These functions will remain in the package for backwards compatibility but it is recommended you migrate to the new server functions. This will require some adjustments to the module server function calling method used in your app. For details on how to migrate see the ‘Migrating from callModule to moduleServer’ section of <a href="https://shiny.rstudio.com/articles/modules.html" class="external-link">Modularizing Shiny app code</a>.</p>
<p>Below is a minimal reproducible example of how to use the authentication modules in a shiny app. Note that this package invisibly calls <code><a href="https://rdrr.io/pkg/shinyjs/man/useShinyjs.html" class="external-link">shinyjs::useShinyjs()</a></code> internally and there is no need for you to do so yourself (although there is no harm if you do).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.posit.co/" class="external-link">shiny</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># dataframe that holds usernames, passwords and other user data</span></span>
<span><span class="va">user_base</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  user <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"user1"</span>, <span class="st">"user2"</span><span class="op">)</span>,</span>
<span>  password <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pass1"</span>, <span class="st">"pass2"</span><span class="op">)</span>,</span>
<span>  permissions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"admin"</span>, <span class="st">"standard"</span><span class="op">)</span>,</span>
<span>  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"User One"</span>, <span class="st">"User Two"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html" class="external-link">fluidPage</a></span><span class="op">(</span></span>
<span>  <span class="co"># add logout button UI</span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">div</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"pull-right"</span>, <span class="fu">shinyauthr</span><span class="fu">::</span><span class="fu"><a href="reference/logoutUI.html">logoutUI</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"logout"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="co"># add login panel UI function</span></span>
<span>  <span class="fu">shinyauthr</span><span class="fu">::</span><span class="fu"><a href="reference/loginUI.html">loginUI</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"login"</span><span class="op">)</span>,</span>
<span>  <span class="co"># setup table output to show user info after login</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderTable.html" class="external-link">tableOutput</a></span><span class="op">(</span><span class="st">"user_table"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># call login module supplying data frame, </span></span>
<span>  <span class="co"># user and password cols and reactive trigger</span></span>
<span>  <span class="va">credentials</span> <span class="op">&lt;-</span> <span class="fu">shinyauthr</span><span class="fu">::</span><span class="fu"><a href="reference/loginServer.html">loginServer</a></span><span class="op">(</span></span>
<span>    id <span class="op">=</span> <span class="st">"login"</span>,</span>
<span>    data <span class="op">=</span> <span class="va">user_base</span>,</span>
<span>    user_col <span class="op">=</span> <span class="va">user</span>,</span>
<span>    pwd_col <span class="op">=</span> <span class="va">password</span>,</span>
<span>    log_out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html" class="external-link">reactive</a></span><span class="op">(</span><span class="fu">logout_init</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># call the logout module with reactive trigger to hide/show</span></span>
<span>  <span class="va">logout_init</span> <span class="op">&lt;-</span> <span class="fu">shinyauthr</span><span class="fu">::</span><span class="fu"><a href="reference/logoutServer.html">logoutServer</a></span><span class="op">(</span></span>
<span>    id <span class="op">=</span> <span class="st">"logout"</span>,</span>
<span>    active <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html" class="external-link">reactive</a></span><span class="op">(</span><span class="fu">credentials</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">user_auth</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">user_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderTable.html" class="external-link">renderTable</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="co"># use req to only render results when credentials()$user_auth is TRUE</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html" class="external-link">req</a></span><span class="op">(</span><span class="fu">credentials</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">user_auth</span><span class="op">)</span></span>
<span>    <span class="fu">credentials</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">info</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span>ui <span class="op">=</span> <span class="va">ui</span>, server <span class="op">=</span> <span class="va">server</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a>
</h2>
<p>When the login module is called, it returns a reactive list containing 2 elements:</p>
<ul>
<li><code>user_auth</code></li>
<li><code>info</code></li>
</ul>
<p>The initial values of these variables are <code>FALSE</code> and <code>NULL</code> respectively. However, given a data frame or tibble containing user names, passwords and other user data (optional), the login module will assign a <code>user_auth</code> value of <code>TRUE</code> if the user supplies a matching user name and password. The value of <code>info</code> then becomes the row of data associated with that user which can be used in the main app to control content based on user permission variables etc.</p>
<p>The logout button will only show when <code>user_auth</code> is <code>TRUE</code>. Clicking the button will reset <code>user_auth</code> back to <code>FALSE</code> which will hide the button and show the login panel again.</p>
<p>You can set the code in your server functions to only run after a successful login through use of the <code><a href="https://rdrr.io/pkg/shiny/man/req.html" class="external-link">req()</a></code> function inside all reactives, renders and observers. In the example above, using <code>req(credentials()$user_auth)</code> inside the <code>renderTable</code> function ensures the table showing the returned user information is only rendered when <code>user_auth</code> is <code>TRUE</code>.</p>
</div>
<div class="section level2">
<h2 id="cookie-based-authentication">Cookie-Based Authentication<a class="anchor" aria-label="anchor" href="#cookie-based-authentication"></a>
</h2>
<p>Most authentication systems use browser cookies to avoid returning users having to re-enter their user name and password every time they return to the app. <code>shinyauthr</code> provides a method for cookie-based automatic login, but you must create your own functions to save and load session info into a database with <a href="https://shiny.rstudio.com/articles/persistent-data-storage.html" class="external-link">persistent data storage</a>.</p>
<p>The first required function must accept two parameters <code>user</code> and <code>session</code>. The first of these is the user name for log in. The second is a randomly generated string that identifies the session. The app asks the user’s web browser to save this session id as a cookie.</p>
<p>The second required function is called without parameters and must return a data.frame of valid <code>user</code> and <code>session</code> ids. If the user’s web browser sends your app a cookie which appears in the <code>session</code> column, then the corresponding <code>user</code> is automatically logged in.</p>
<p>Pass these functions to the login module via <code>shinyauthr::loginServer(...)</code> as the <code>cookie_setter</code> and <code>cookie_getter</code> parameters. A minimal example, using <a href="https://rsqlite.r-dbi.org/" class="external-link">RSQLite</a> as a local database to write and store user session data, is below.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.posit.co/" class="external-link">shiny</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dbi.r-dbi.org" class="external-link">DBI</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rsqlite.r-dbi.org" class="external-link">RSQLite</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># connect to, or setup and connect to local SQLite db</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="st">"my_db_file"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">db</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu"><a href="https://rsqlite.r-dbi.org/reference/SQLite.html" class="external-link">SQLite</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"my_db_file"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">db</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu"><a href="https://rsqlite.r-dbi.org/reference/SQLite.html" class="external-link">SQLite</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"my_db_file"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbCreateTable.html" class="external-link">dbCreateTable</a></span><span class="op">(</span><span class="va">db</span>, <span class="st">"sessionids"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>user <span class="op">=</span> <span class="st">"TEXT"</span>, sessionid <span class="op">=</span> <span class="st">"TEXT"</span>, login_time <span class="op">=</span> <span class="st">"TEXT"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># a user who has not visited the app for this many days</span></span>
<span><span class="co"># will be asked to login with user name and password again</span></span>
<span><span class="va">cookie_expiry</span> <span class="op">&lt;-</span> <span class="fl">7</span> <span class="co"># Days until session expires</span></span>
<span></span>
<span><span class="co"># This function must accept two parameters: user and sessionid. It will be called whenever the user</span></span>
<span><span class="co"># successfully logs in with a password.  This function saves to your database.</span></span>
<span></span>
<span><span class="va">add_sessionid_to_db</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">user</span>, <span class="va">sessionid</span>, <span class="va">conn</span> <span class="op">=</span> <span class="va">db</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>user <span class="op">=</span> <span class="va">user</span>, sessionid <span class="op">=</span> <span class="va">sessionid</span>, login_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html" class="external-link">now</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbWriteTable.html" class="external-link">dbWriteTable</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"sessionids"</span>, <span class="va">.</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># This function must return a data.frame with columns user and sessionid  Other columns are also okay</span></span>
<span><span class="co"># and will be made available to the app after log in as columns in credentials()$user_auth</span></span>
<span></span>
<span><span class="va">get_sessionids_from_db</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">conn</span> <span class="op">=</span> <span class="va">db</span>, <span class="va">expiry</span> <span class="op">=</span> <span class="va">cookie_expiry</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbReadTable.html" class="external-link">dbReadTable</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"sessionids"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>login_time <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="va">login_time</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">login_time</span> <span class="op">&gt;</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html" class="external-link">now</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">days</a></span><span class="op">(</span><span class="va">expiry</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># dataframe that holds usernames, passwords and other user data</span></span>
<span><span class="va">user_base</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  user <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"user1"</span>, <span class="st">"user2"</span><span class="op">)</span>,</span>
<span>  password <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pass1"</span>, <span class="st">"pass2"</span><span class="op">)</span>,</span>
<span>  permissions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"admin"</span>, <span class="st">"standard"</span><span class="op">)</span>,</span>
<span>  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"User One"</span>, <span class="st">"User Two"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html" class="external-link">fluidPage</a></span><span class="op">(</span></span>
<span>  <span class="co"># add logout button UI</span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">div</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"pull-right"</span>, <span class="fu">shinyauthr</span><span class="fu">::</span><span class="fu"><a href="reference/logoutUI.html">logoutUI</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"logout"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="co"># add login panel UI function</span></span>
<span>  <span class="fu">shinyauthr</span><span class="fu">::</span><span class="fu"><a href="reference/loginUI.html">loginUI</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"login"</span>, cookie_expiry <span class="op">=</span> <span class="va">cookie_expiry</span><span class="op">)</span>,</span>
<span>  <span class="co"># setup table output to show user info after login</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderTable.html" class="external-link">tableOutput</a></span><span class="op">(</span><span class="st">"user_table"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># call the logout module with reactive trigger to hide/show</span></span>
<span>  <span class="va">logout_init</span> <span class="op">&lt;-</span> <span class="fu">shinyauthr</span><span class="fu">::</span><span class="fu"><a href="reference/logoutServer.html">logoutServer</a></span><span class="op">(</span></span>
<span>    id <span class="op">=</span> <span class="st">"logout"</span>,</span>
<span>    active <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html" class="external-link">reactive</a></span><span class="op">(</span><span class="fu">credentials</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">user_auth</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># call login module supplying data frame, user and password cols</span></span>
<span>  <span class="co"># and reactive trigger</span></span>
<span>  <span class="va">credentials</span> <span class="op">&lt;-</span> <span class="fu">shinyauthr</span><span class="fu">::</span><span class="fu"><a href="reference/loginServer.html">loginServer</a></span><span class="op">(</span></span>
<span>    id <span class="op">=</span> <span class="st">"login"</span>,</span>
<span>    data <span class="op">=</span> <span class="va">user_base</span>,</span>
<span>    user_col <span class="op">=</span> <span class="va">user</span>,</span>
<span>    pwd_col <span class="op">=</span> <span class="va">password</span>,</span>
<span>    cookie_logins <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    sessionid_col <span class="op">=</span> <span class="va">sessionid</span>,</span>
<span>    cookie_getter <span class="op">=</span> <span class="va">get_sessionids_from_db</span>,</span>
<span>    cookie_setter <span class="op">=</span> <span class="va">add_sessionid_to_db</span>,</span>
<span>    log_out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html" class="external-link">reactive</a></span><span class="op">(</span><span class="fu">logout_init</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># pulls out the user information returned from login module</span></span>
<span>  <span class="va">user_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html" class="external-link">reactive</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu">credentials</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">info</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">user_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderTable.html" class="external-link">renderTable</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="co"># use req to only render results when credentials()$user_auth is TRUE</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html" class="external-link">req</a></span><span class="op">(</span><span class="fu">credentials</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">user_auth</span><span class="op">)</span></span>
<span>    <span class="fu">user_data</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"login_time"</span><span class="op">)</span>, <span class="va">as.character</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span>ui <span class="op">=</span> <span class="va">ui</span>, server <span class="op">=</span> <span class="va">server</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="hashing-passwords-with-sodium">Hashing Passwords with <code>sodium</code>
<a class="anchor" aria-label="anchor" href="#hashing-passwords-with-sodium"></a>
</h2>
<p>If you are hosting your user passwords on the internet, it is a good idea to first encrypt them with a hashing algorithm. You can use the <a href="https://github.com/jeroen/sodium" class="external-link">sodium package</a> to do this. Sodium uses a slow hashing algorithm that is specifically designed to protect stored passwords from brute-force attacks. More on this <a href="https://doc.libsodium.org/password_hashing/" class="external-link">here</a>. You then tell the <code><a href="reference/loginServer.html">shinyauthr::loginServer</a></code> module that your passwords have been hashed by <code>sodium</code> and <code>shinyauthr</code> will then decrypt when login is requested. Your plain text passwords must be a character vector, not factors, when hashing for this to work as shiny inputs are passed as character strings.</p>
<p>For example, a sample user base like the following can be incorporated for use with <code>shinyauthr</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a user base then hash passwords with sodium</span></span>
<span><span class="co"># then save to an rds file in app directory</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/sodium/" class="external-link">sodium</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">user_base</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  user <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"user1"</span>, <span class="st">"user2"</span><span class="op">)</span>,</span>
<span>  password <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_chr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pass1"</span>, <span class="st">"pass2"</span><span class="op">)</span>, <span class="fu">sodium</span><span class="fu">::</span><span class="va"><a href="https://docs.ropensci.org/sodium/reference/password.html" class="external-link">password_store</a></span><span class="op">)</span>,</span>
<span>  permissions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"admin"</span>, <span class="st">"standard"</span><span class="op">)</span>,</span>
<span>  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"User One"</span>, <span class="st">"User Two"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">user_base</span>, <span class="st">"user_base.rds"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># in your app code, read in the user base rds file</span></span>
<span><span class="va">user_base</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"user_base.rds"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># then when calling the module set sodium_hashed = TRUE</span></span>
<span><span class="va">credentials</span> <span class="op">&lt;-</span> <span class="fu">shinyauthr</span><span class="fu">::</span><span class="fu"><a href="reference/loginServer.html">loginServer</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="st">"login"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">user_base</span>,</span>
<span>  user_col <span class="op">=</span> <span class="va">user</span>,</span>
<span>  pwd_col <span class="op">=</span> <span class="va">password</span>,</span>
<span>  sodium_hashed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  log_out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html" class="external-link">reactive</a></span><span class="op">(</span><span class="fu">logout_init</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="credits">Credits<a class="anchor" aria-label="anchor" href="#credits"></a>
</h2>
<p><code>shinyauthr</code> originally borrowed some code from treysp’s <a href="https://github.com/treysp/shiny_password" class="external-link">shiny_password</a> template with the goal of making implementation simpler for end users and allowing the login/logout UIs to fit easily into any UI framework, including <a href="https://rstudio.github.io/shinydashboard/" class="external-link">shinydashboard</a>.</p>
<p>Thanks to <a href="https://github.com/michael-dewar" class="external-link">Michael Dewar</a> for his contribution of cookie-based authentication. Some code was borrowed from calligross’s <a href="https://gist.github.com/calligross/e779281b500eb93ee9e42e4d72448189" class="external-link">Shiny Cookie Based Authentication Example</a> and from an earlier PR from <a href="https://github.com/aqualogy/shinyauthr" class="external-link">aqualogy</a>.</p>
</div>
<div class="section level2">
<h2 id="disclaimer">Disclaimer<a class="anchor" aria-label="anchor" href="#disclaimer"></a>
</h2>
<p>I’m not a security professional so cannot guarantee this authentication procedure to be foolproof. It is ultimately the shiny app developer’s responsibility not to expose any sensitive content to the client without the necessary login criteria being met.</p>
<p>I would welcome any feedback on any potential vulnerabilities in the process. I know that apps hosted on a server without an SSL certificate could be open to interception of user names and passwords submitted by a user. As such I would not recommend the use of shinyauthr without a HTTPS connection.</p>
<p>For apps intended for use within commercial organisations, I would recommend one of RStudio’s commercial shiny hosting options, or <a href="https://www.shinyproxy.io/" class="external-link">shinyproxy</a>, both of which have built in authentication options.</p>
<p>However, I hope that having an easy-to-implement open-source shiny authentication option like this will prove useful when alternative options are not feasible.</p>
<p><em>Paul Campbell</em></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=shinyauthr" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/paulc91/shinyauthr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/paulc91/shinyauthr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing shinyauthr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://github.com/paulc91" class="external-link">Paul Campbell</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-1018-6606" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://CRAN.R-project.org/package=shinyauthr" class="external-link"><img src="https://www.r-pkg.org/badges/version/shinyauthr" alt="CRAN status"></a></li>
<li><a href="https://cran.r-project.org/package=shinyauthr" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/shinyauthr"></a></li>
<li><a href="https://cran.r-project.org/package=shinyauthr" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/shinyauthr"></a></li>
<li><a href="https://github.com/PaulC91/shinyauthr/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/PaulC91/shinyauthr/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://codecov.io/gh/PaulC91/shinyauthr?branch=master" class="external-link"><img src="https://codecov.io/gh/PaulC91/shinyauthr/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://github.com/paulc91" class="external-link">Paul Campbell</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
